# CI/CD
The Istio module contains several pipelines that run on pull requests, on the main branch, on the release branch, and periodically. They perform various tasks such as running a linter, executing unit tests with code coverage, generating artifacts for development and production purposes, and running integration tests. The integration tests ensure the functional correctness of Kyma Istio Operator and verify if upgrading to the new version of Kyma Istio Operator is possible.

## Pipelines Running on Pull Requests to the Main Branch

The following CI jobs are part of the development cycle.

| Name                                                                                                                                                                                                        | Description                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| [`Wait for image build`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L23)                                                   | Waits for the operator's image build to finish so that the image-dependent jobs can be executed.                                                       |
| [`pull-istio-operator-build`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/istio/istio-manager.yaml#L6)                                 | Builds Kyma Istio Operator's image and pushes it to the `dev` registry.                                                                                |
| [`Pull Request integration test / Istio integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L59)                                 | Executes the main integration test suite for the Istio module on a k3d cluster.                                                                        |
| [`Pull Request integration test / Istio integration test evaluation`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L75)                     | Executes the main integration test suite for the Istio module in the evaluation profile on a k3d cluster.                                              |
| [`pre-istio-presubmit-scanner`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/test-infra/presubmit-scanner.yaml#L354)                     | Runs the Gitleaks presubmit scanner to detect any sensitive data that might have been committed.                                                       |
| [`Pull Request integration tests / Kubernetes version compatibility test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L34) | Executes the basic integration test suite for the Istio module and checks if any incompatibilities occurred during the execution.                      |
| [`Pull Request integration tests / Istio upgrade integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L45)        | Executes the upgrade integration test suite for the Istio module and verifies if the existing release can be successfully upgraded to the new version. |
| [`Pull Request / lint`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-request.yaml#L24)                                                        | Performs linting.                                                                                                                                      |
| [`Pull Request / Run unit tests`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-request.yaml#L40)                                              | Runs unit tests with code coverage information.                                                                                                        |
| [`UI Tests / Run UI tests`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/ui-tests.yaml#L22) | Runs UI tests for Busola extenstions of API Gateway module and API Rules. |
| [`Workflow validation / Ensure SHA pinned actions`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/verify-commit-pins.yaml#L15) | Verifies that all external actions are pinned to a commit. |

## Pipelines Running on Merge to Main and All Release Branches

The following CI jobs run when you merge changes to the `main` branch and all release branches.

| Name                                                                                                                                                                                          | Description                                                                                                                                       |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [`post-istio-operator-build`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/istio/istio-manager.yaml#L117)                  | Builds Kyma Istio Operator's image and pushes it to the `prod` registry.                                                                          |
| [`main integration tests / Istio integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L46)                  | Executes the main integration test suite for Istio Manager on a k3d cluster.                                                                      |
| [`main integration tests / Istio integration test AWS specific`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L92)        | Executes the integration test suite specific for AWS Hyperscaler.                                                                                 |
| [`main integration tests / Istio integration test GCP`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L60)        | Executes the integration test suite specific for GCP Hyperscaler.                                                                                 |
| [`main integration tests / Wait for image build`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L22)            | Waits for the operator's image build to finish so that image-dependent jobs can be executed.                                                      |
| [`main integration tests / Istio upgrade integration tests`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L32) | Executes the upgrade integration test suite of Istio Module and verifies if the existing release can be successfully upgraded to the new version. |
| [`main integration tests / Slack Notification`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L156)              | Sends a Slack notification to the team's channel if any pipelines fail on the main branch.                                                        |

## Pipelines Running on Pull Requests to Release Branches

The following CI jobs generate release artifacts and verify the functional correctness of Istio Manager. They run on the PR to the release branch.

| Name                                                                                                                                                                                                        | Description                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| [`Wait for image build`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L23)                                                   | Waits for the operator's image build to finish so that the image-dependent jobs can be executed.                                                       |
| [`pull-istio-operator-build`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/istio/istio-manager.yaml#L6)                                 | Builds Kyma Istio Operator's image and pushes it to the `dev` registry.                                                                                |
| [`Pull Request integration test / Istio integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L59)                                 | Executes the main integration test suite for the Istio module on a k3d cluster.                                                                        |
| [`Pull Request integration test / Istio integration test evaluation`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L75)                     | Executes the main integration test suite for the Istio module in the evaluation profile on a k3d cluster.                                              |
| [`PR Integration Gardener / Istio integration test GCP`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration-gardener.yaml#L39)                      | Executes the main integration test suite for the Istio module on a Gardener GCP cluster.                                                               |
| [`PR Integration Gardener / Istio integration test AWS specific`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration-gardener.yaml#L73)                      | Executes the integration test suite specific for AWS Hyperscaler.                                                                                      |
| [`pre-istio-presubmit-scanner`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/test-infra/presubmit-scanner.yaml#L354)                     | Runs the Gitleaks presubmit scanner to detect any sensitive data that might have been committed.                                                       |
| [`Pull Request integration tests / Kubernetes version compatibility test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L34) | Executes the basic integration test suite for the Istio module and checks if any incompatibilities occurred during the execution.                      |
| [`Pull Request integration tests / Istio upgrade integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-integration.yaml#L45)        | Executes the upgrade integration test suite for the Istio module and verifies if the existing release can be successfully upgraded to the new version. |
| [`Pull Request / lint`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-request.yaml#L25)                                                        | Performs linting.                                                                                                                                      |
| [`Pull Request / Run unit tests`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/pull-request.yaml#L40)                                              | Runs unit tests with code coverage information.                                                                                                        |
| [`UI Tests / Run UI tests`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/ui-tests.yaml#L22) | Runs UI tests for Busola extenstions of API Gateway module and API Rules. |

## Pipelines Running on the Release Branch

The following CI jobs generate release artifacts and verify the functional correctness of Kyma Istio Operator.

| Name                                                                                                                                                                         | Description                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [`Istio integration test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/main-integration.yaml#L46) | Executes the main integration test suite for the Istio module on a k3d cluster.         |
| [`rel-istio-build`](https://github.com/kyma-project/test-infra/blob/578e4bb754b1bf12e1964cb96436bd25b7c21996/prow/jobs/kyma-project/istio/istio-manager.yaml#L61)           | Builds Kyma Istio Operator's image on the release and pushes it to the `prod` registry. |
| [`Create release / Check release prerequisites`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/create-release.yaml#L17) | Checks whether all pre-requesites for release are met |
| [`Create release / Create draft release`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/create-release.yaml#L44) | Create a draft release that will be updated with release artifacts |
| [`Create release / Publish release`](https://github.com/kyma-project/istio/blob/d91645ab9c8935da03f82ed87623663cf2a621ad/.github/workflows/create-release.yaml#L76) | Publish the previously created draft release |

## Pipelines Running on a Schedule

The following CI jobs are scheduled to run at specific times.

| Name                                                                                                                                                                                  | Description                                                                             |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [`Istio performance test`](https://github.com/kyma-project/istio/blob/fd34803dd516c3b614fda4f5b9d9a4c8b46372bb/.github/workflows/performance-test.yaml#L10) | Runs Istio Manager's performance tests every day at 12:00 AM on a Gardener GCP cluster. |
