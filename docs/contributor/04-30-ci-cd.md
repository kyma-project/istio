# CI/CD

## Pipelines running on pull requests

The following CI jobs are part of the development cycle. They run linter, unit tests with code coverage, generate development purpose artifacts and run integration tests against them to verify the functional correctness of Istio Manager including possibility of upgrade to the new version

| Name                                                                                                                                                                    | Description                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| [`Wait for image build`](https://github.com/kyma-project/istio/blob/main/.github/workflows/pull-integration.yaml#L22)                                                   | Waits for the operator's image build to finish so that the image-dependent jobs can be executed.                                                       |
| [`pull-istio-operator-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L51)                                              | Builds Istio Operator's image and pushes it to the `dev` registry.                                                                                |
| [`pull-istio-module-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L6)                                                 | Builds ModuleTemplate for the Istio module and pushes it to the `dev` registry.                                                                   |
| [`pull-istio-integration`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-integration.yaml#L3)                                              | Executes the main integration test suite for the Istio module on a k3d cluster.                                                                       |
| [`pull-istio-integration-evaluation`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-integration.yaml#L44)                                  | Executes the main integration test suite for the Istio module in the evaluation profile on a k3d cluster.                                                 |
| [`pull-istio-operator-integration-gcp`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L102)                                   | Executes the main integration test suite for the Istio module on a Gardener GCP cluster.                                                              |
| [`pre-istio-presubmit-scanner`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/test-infra/presubmit-scanner.yaml#L470)                                  | Runs Gitleaks presubmit scanner to detect commited sensitive data.                                                                              |
| [`Pull Request integration tests / Kubernetes version compatibility test`](https://github.com/kyma-project/istio/blob/main/.github/workflows/pull-integration.yaml#L33) | Executes basic integration test suite for Istio Module and checks if any incompatibilities occurred during the execution.                       |
| [`Pull Request integration tests / Istio upgrade integration test`](https://github.com/kyma-project/istio/blob/main/.github/workflows/pull-integration.yaml#L44)        | Executes upgrade integration test suite for Istio Module. It checks if upgrade of existing release to the new version can be done successfully. |
| [`Pull Request / lint`](https://github.com/kyma-project/istio/blob/main/.github/workflows/pull-request.yaml#L24)                                                        | Responsible for linting, static code analysis.                                                                                                  |
| [`Pull Request / Run unit tests`](https://github.com/kyma-project/istio/blob/main/.github/workflows/pull-request.yaml#L39)                                              | Responsible for running unit tests with code coverage information.                                                                              |

## Pipelines running on main branch

The following CI jobs run on main branch. They generate production ready artifacts and run integration tests against them to verify functional correctness of Istio Manager including possibility of upgrade to the new version.

| Name                                                                                                                                                      | Description                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| [`post-istio-operator-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L308)                               | Builds Istio operator image and pushes it into the prod registry.                                                                           |
| [`post-istio-module-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L163)                                 | Builds ModuleTemplate for the Istio module and pushes it to the prod registry.                                                              |
| [`post-istio-integration`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-integration.yaml#L87)                               | Executes main integration test suite for Istio Manager on k3d cluster.                                                                      |
| [`main integration tests / Wait for image build`](https://github.com/kyma-project/istio/blob/main/.github/workflows/main-integration.yaml#L20)            | Waits for operator image build to finish so the image dependent jobs can be executed.                                                       |
| [`main integration tests / Istio upgrade integration tests`](https://github.com/kyma-project/istio/blob/main/.github/workflows/main-integration.yaml#L30) | Executes upgrade integration test suite of Istio Module. It checks if upgrade existing release to the new version can be done successfully. |
| [`main integration tests / Slack Notification`](https://github.com/kyma-project/istio/blob/main/.github/workflows/main-integration.yaml#L42)              | In case of failed pipelines on main branch it sends Slack notification to the team's channel.                                               |

## Pipelines running on release branch

The following CI jobs generate release artifacts and verify the functional correctness of Istio Manager.

| Name                                                                                                                        | Description                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| [`post-istio-integration`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-integration.yaml#L87) | Executes main integration test suite for Istio Module on k3d cluster.            |
| [`rel-istio-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L208)           | Builds Istio Operator's image on the release and pushes it to the `prod` registry. |
| [`rel-istio-module-build`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L263)    | Builds Istio ModuleTemplate on the release and pushes it to the `prod` registry. |

## Pipelines running on a schedule

The following CI jobs are scheduled to run at specific times.

| Name                                                                                                                                 | Description                                                                         |
|--------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
| [`nightly-istio-performance-test-gcp`](https://github.com/kyma-project/test-infra/blob/main/prow/jobs/istio/istio-manager.yaml#L365) | Runs Istio Manager's performance tests every day at 12:00 AM on a Gardener GCP cluster. |